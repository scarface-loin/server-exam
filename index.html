<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R√©sultats Examen</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 16px;
            color: #1f2937;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .header h1 {
            font-size: 1.5rem;
            color: #111827;
            margin-bottom: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 12px;
            border-radius: 12px;
            color: white;
        }

        .stat-label {
            font-size: 0.75rem;
            opacity: 0.9;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        /* L√©gende */
        .legend {
            background: white;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 16px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            font-size: 0.85rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-box {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        /* Student Cards */
        .student-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .student-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: transform 0.2s;
        }

        .student-card:active {
            transform: scale(0.98);
        }

        .student-header {
            padding: 16px;
            background: linear-gradient(135deg, #f9fafb 0%, #e5e7eb 100%);
            border-bottom: 2px solid #e5e7eb;
        }

        .student-name {
            font-size: 1.1rem;
            font-weight: bold;
            color: #111827;
            margin-bottom: 4px;
        }

        .student-phone {
            font-size: 0.85rem;
            color: #6b7280;
        }

        .score-section {
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fafafa;
        }

        .score-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .score-high { 
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        .score-med { 
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        .score-low { 
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .answers-section {
            padding: 16px;
        }

        .section-title {
            font-size: 0.75rem;
            font-weight: bold;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
        }

        .answer-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            margin-bottom: 16px;
        }

        .ans-box {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: bold;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .ans-correct {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .ans-wrong {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            position: relative;
        }

        .ans-wrong::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 10%;
            right: 10%;
            height: 2px;
            background: white;
            transform: translateY(-50%) rotate(-20deg);
        }

        .ans-empty {
            background: #e5e7eb;
            color: #9ca3af;
        }

        .question-label {
            position: absolute;
            top: -8px;
            left: -8px;
            background: #1f2937;
            color: white;
            font-size: 0.6rem;
            padding: 2px 4px;
            border-radius: 4px;
            font-weight: bold;
        }

        /* Empty state */
        .no-answers {
            padding: 20px;
            text-align: center;
            color: #9ca3af;
            font-style: italic;
            background: #f9fafb;
            border-radius: 12px;
            margin: 12px 16px;
        }

        /* Filters */
        .filters {
            background: white;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 16px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .filter-buttons {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 4px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.2s;
            cursor: pointer;
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }

        /* Desktop adjustments */
        @media (min-width: 768px) {
            .container {
                max-width: 1200px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .answer-grid {
                grid-template-columns: repeat(10, 1fr);
            }

            .student-list {
                grid-template-columns: repeat(2, 1fr);
                display: grid;
            }
        }

        @media (min-width: 1024px) {
            .student-list {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>

<div class="container">
    <!-- Header avec stats -->
    <div class="header">
        <h1>üìä R√©sultats Telc B1</h1>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Total √©l√®ves</div>
                <div class="stat-value" id="totalStudents">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Ont r√©pondu</div>
                <div class="stat-value" id="answeredStudents">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Moyenne</div>
                <div class="stat-value" id="avgScore">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Meilleur</div>
                <div class="stat-value" id="bestScore">0</div>
            </div>
        </div>
    </div>

    <!-- L√©gende -->
    <div class="legend">
        <div class="legend-item">
            <div class="legend-box" style="background: linear-gradient(135deg, #10b981, #059669)"></div>
            <span>Correct</span>
        </div>
        <div class="legend-item">
            <div class="legend-box" style="background: linear-gradient(135deg, #ef4444, #dc2626)"></div>
            <span>Faux</span>
        </div>
        <div class="legend-item">
            <div class="legend-box" style="background: #e5e7eb"></div>
            <span>Non r√©pondu</span>
        </div>
    </div>

    <!-- Filtres -->
    <div class="filters">
        <div class="filter-buttons">
            <button class="filter-btn active" onclick="filterResults('all')">Tous</button>
            <button class="filter-btn" onclick="filterResults('answered')">Ont r√©pondu</button>
            <button class="filter-btn" onclick="filterResults('high')">‚â•35 pts</button>
            <button class="filter-btn" onclick="filterResults('medium')">20-34 pts</button>
            <button class="filter-btn" onclick="filterResults('low')">< 20 pts</button>
        </div>
    </div>

    <!-- Liste des √©l√®ves -->
    <div class="student-list" id="studentList"></div>
</div>

<script>
    const studentsData = [
      { "name": "Murielle ", "phone": "57160356", "answers": { "1": "c", "2": "j", "3": "h", "4": "a", "5": "i", "11": "D", "12": "H", "13": "J", "14": "H", "15": "F", "16": "C", "17": "E", "18": "F", "19": "A", "20": "C" } },
      { "name": "Ngouekui Elessa carelke", "phone": "640014356", "answers": { "1": "h", "2": "f", "3": "c", "4": "a", "5": "d" } },
      { "name": "stevesoft", "phone": "650892780", "answers": {} },
      { "name": "Yvana Sorem", "phone": "653336769", "answers": {} },
      { "name": "Mamno arianne", "phone": "655414398", "answers": {} },
      { "name": "Arland jean", "phone": "655894529", "answers": {} },
      { "name": "Donpe kamdem Kendra ", "phone": "656392256", "answers": { "1": "h", "2": "d", "3": "a", "4": "d", "5": "i" } },
      { "name": "Sonwa belviane ", "phone": "658694852", "answers": {} },
      { "name": "Mabelle", "phone": "658819968", "answers": {} },
      { "name": "Yiagnigni Mariama ", "phone": "671261314", "answers": { "1": "d", "2": "a", "3": "c", "4": "i", "5": "a", "11": "K", "12": "H", "13": "x", "14": "B", "15": "F", "16": "A", "17": "E", "18": "x", "19": "A", "20": "C" } },
      { "name": "Manboy", "phone": "674148151", "answers": { "1": "b", "2": "f", "3": "c", "4": "a", "5": "d", "11": "D", "12": "L", "13": "H", "14": "J", "15": "G", "16": "B", "18": "K", "19": "A", "20": "C" } },
      { "name": "Mbeleck Manuel Florent Rene", "phone": "674307121", "answers": {} },
      { "name": "Mbappe ", "phone": "677307487", "answers": { "1": "a", "2": "b", "3": "c", "4": "c", "5": "d" } },
      { "name": "Heudou ariane", "phone": "680350112", "answers": {} },
      { "name": "Mapitsop fopa Ange charone ", "phone": "683198041", "answers": { "1": "b", "2": "f", "3": "c", "4": "a", "5": "i", "11": "I", "12": "J", "13": "L", "14": "H", "15": "F", "16": "G", "17": "C", "18": "K", "19": "A", "20": "B" } },
      { "name": "Brayan ngueleu ", "phone": "683239008", "answers": {} },
      { "name": "Chico ", "phone": "686078616", "answers": {} },
      { "name": "Djoulefack tsana Brionne ", "phone": "686563539", "answers": {} },
      { "name": "Jos√© Rabi", "phone": "690842858", "answers": {} },
      { "name": "Deuco M√©lissa ", "phone": "691351889", "answers": {} },
      { "name": "VOUGMO YEMELE RAYELLE ", "phone": "691381769", "answers": { "1": "b", "2": "f", "3": "g", "4": "a", "5": "d", "11": "D", "12": "H", "13": "J", "14": "E", "15": "F", "16": "B", "17": "x", "18": "G", "19": "A", "20": "C" } },
      { "name": "MEPONDJOU TSAGUE CLAUVINETTE ", "phone": "691881482", "answers": { "1": "f", "2": "i", "3": "a", "4": "d", "5": "c" } },
      { "name": "Ma√Ølova", "phone": "694734474", "answers": {} },
      { "name": "Ange serena Akedi", "phone": "694779950", "answers": {} },
      { "name": "Romy", "phone": "695008777", "answers": {} },
      { "name": "Loic", "phone": "695068073", "answers": { "11": "x", "12": "J", "13": "J", "14": "H", "15": "G", "16": "B", "17": "x", "18": "x", "19": "A", "20": "C" } },
      { "name": "Sarbe Hamadama ", "phone": "696586363", "answers": { "1": "b", "2": "f", "3": "g", "4": "a", "5": "j", "11": "D", "12": "H", "13": "J", "14": "x", "15": "F", "16": "B", "17": "E", "18": "G", "19": "A", "20": "C" } },
      { "name": "Boris", "phone": "697898974", "answers": { "11": "F", "12": "L", "13": "J", "14": "H", "15": "A", "16": "B", "17": "E", "18": "x", "19": "F", "20": "D" } },
      { "name": "Kelly ", "phone": "698769367", "answers": {} },
      { "name": "Soraya Tcheutchoua", "phone": "698899888", "answers": { "1": "b", "2": "f", "3": "c", "4": "a", "5": "i" } }
    ];

    const solutionKey = {
        "1": "h", "2": "f", "3": "c", "4": "a", "5": "d",
        "11": "d", "12": "h", "13": "x", "14": "j", "15": "f", 
        "16": "b", "17": "e", "18": "x", "19": "a", "20": "c"
    };

    let allStudentsWithScores = [];

    function calculateScore(student) {
        let scoreTotal = 0;
        let details = { part1: [], part3: [] };

        for(let i=1; i<=5; i++) {
            const qId = i.toString();
            const correct = solutionKey[qId];
            const studentAns = (student.answers[qId] || "").toLowerCase();
            const isCorrect = studentAns === correct;
            
            if(isCorrect) scoreTotal += 5;
            
            details.part1.push({
                q: i,
                answer: studentAns || "-",
                correct: isCorrect,
                expected: correct
            });
        }

        for(let i=11; i<=20; i++) {
            const qId = i.toString();
            const correct = solutionKey[qId];
            const studentAns = (student.answers[qId] || "").toLowerCase();
            const isCorrect = studentAns === correct;
            
            if(isCorrect) scoreTotal += 2.5;
            
            details.part3.push({
                q: i,
                answer: studentAns || "-",
                correct: isCorrect,
                expected: correct
            });
        }

        return { score: scoreTotal, details };
    }

    function renderStudentCard(student, scoreData) {
        const { score, details } = scoreData;
        const hasAnswers = Object.keys(student.answers).length > 0;
        
        let badgeClass = "score-low";
        if(score >= 35) badgeClass = "score-high";
        else if(score >= 20) badgeClass = "score-med";

        let html = `
            <div class="student-card" data-score="${score}" data-answered="${hasAnswers}">
                <div class="student-header">
                    <div class="student-name">${student.name}</div>
                    <div class="student-phone">üì± ${student.phone}</div>
                </div>
                <div class="score-section">
                    <span style="font-weight: 600; color: #6b7280;">Note finale</span>
                    <span class="score-badge ${badgeClass}">${score}/50</span>
                </div>
        `;

        if(hasAnswers) {
            html += `
                <div class="answers-section">
                    <div class="section-title">Partie 1 (5 pts/q)</div>
                    <div class="answer-grid">
            `;
            
            details.part1.forEach(item => {
                const className = item.answer === "-" ? "ans-empty" : (item.correct ? "ans-correct" : "ans-wrong");
                html += `
                    <div class="ans-box ${className}">
                        <span class="question-label">${item.q}</span>
                        ${item.answer.toUpperCase()}
                    </div>
                `;
            });

            html += `
                    </div>
                    <div class="section-title">Partie 3 (2.5 pts/q)</div>
                    <div class="answer-grid">
            `;

            details.part3.forEach(item => {
                const className = item.answer === "-" ? "ans-empty" : (item.correct ? "ans-correct" : "ans-wrong");
                html += `
                    <div class="ans-box ${className}">
                        <span class="question-label">${item.q}</span>
                        ${item.answer.toUpperCase()}
                    </div>
                `;
            });

            html += `</div></div>`;
        } else {
            html += `<div class="no-answers">‚ùå Aucune r√©ponse enregistr√©e</div>`;
        }

        html += `</div>`;
        return html;
    }

    function renderAllStudents() {
        const listEl = document.getElementById('studentList');
        listEl.innerHTML = '';

        allStudentsWithScores = studentsData.map(student => {
            const scoreData = calculateScore(student);
            return { ...student, ...scoreData };
        });

        // Stats
        const totalStudents = allStudentsWithScores.length;
        const answeredStudents = allStudentsWithScores.filter(s => Object.keys(s.answers).length > 0).length;
        const scores = allStudentsWithScores.filter(s => Object.keys(s.answers).length > 0).map(s => s.score);
        const avgScore = scores.length > 0 ? (scores.reduce((a,b) => a+b, 0) / scores.length).toFixed(1) : 0;
        const bestScore = scores.length > 0 ? Math.max(...scores) : 0;

        document.getElementById('totalStudents').textContent = totalStudents;
        document.getElementById('answeredStudents').textContent = answeredStudents;
        document.getElementById('avgScore').textContent = avgScore;
        document.getElementById('bestScore').textContent = bestScore;

        // Tri par score d√©croissant
        allStudentsWithScores.sort((a, b) => b.score - a.score);

        allStudentsWithScores.forEach(student => {
            listEl.innerHTML += renderStudentCard(student, { score: student.score, details: student.details });
        });
    }

    function filterResults(type) {
        document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');

        const cards = document.querySelectorAll('.student-card');
        
        cards.forEach(card => {
            const score = parseFloat(card.dataset.score);
            const hasAnswered = card.dataset.answered === 'true';
            let show = true;

            switch(type) {
                case 'answered':
                    show = hasAnswered;
                    break;
                case 'high':
                    show = score >= 35;
                    break;
                case 'medium':
                    show = score >= 20 && score < 35;
                    break;
                case 'low':
                    show = score < 20;
                    break;
            }

            card.style.display = show ? 'block' : 'none';
        });
    }

    renderAllStudents();
</script>

</body>
</html>